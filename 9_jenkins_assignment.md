# Jenkins Setup and CI/CD Pipeline Creation Guide

This guide will walk you through the process of setting up Jenkins, installing the required software, creating Jenkins jobs, configuring slave nodes, and automating the deployment pipeline for continuous integration (CI) and continuous deployment (CD). 

## Table of Contents
1. [Introduction to Jenkins](#introduction-to-jenkins)
2. [Setting Up Jenkins](#setting-up-jenkins)
3. [Creating Jenkins Jobs](#creating-jenkins-jobs)
4. [Setting Up Slave Nodes](#setting-up-slave-nodes)
5. [Creating CI/CD Pipeline](#creating-cicd-pipeline)
6. [Final Configuration and Troubleshooting](#final-configuration-and-troubleshooting)
7. [Conclusion](#conclusion)

---

## Introduction to Jenkins
Jenkins is an open-source automation server used for Continuous Integration and Continuous Deployment (CI/CD). It helps automate repetitive tasks such as pulling code from GitHub, building applications, running tests, and deploying to production servers. 

### Why Jenkins?
Jenkins is popular for:
- Automating build processes.
- Continuous integration with version control systems (e.g., GitHub).
- Seamless integration with build tools like Maven, Gradle, etc.
- Continuous deployment to staging/production environments.

---

## Setting Up Jenkins

Before diving into Jenkins, you need to ensure that the necessary software is installed on both your Jenkins Master and Slave machines. 

### Prerequisites:
- Java (Java 17 recommended)
- Git

### Steps to Set Up Jenkins Master:
1. **Install Java:**
   On the Jenkins master machine, run:
   ```bash
   sudo apt install openjdk-17-jdk -y
   ```
   To verify Java installation, run:
   ```bash
   java -version
   ```

2. **Install Jenkins:**
   - Create a script `jenkins_install.sh` and paste the following commands:
     ```bash
     sudo apt update
     sudo apt install wget
     wget -q -O - https://pkg.jenkins.io/keys/jenkins.io.key | sudo apt-key add -
     sudo sh -c 'echo deb http://pkg.jenkins.io/debian/jenkins.io.key /etc/apt/sources.list.d/jenkins.list'
     sudo apt update
     sudo apt install jenkins
     ```

3. **Start Jenkins:**
   Run the following command to check if Jenkins is running:
   ```bash
   service jenkins status
   ```
   If Jenkins is not running, start it with:
   ```bash
   service jenkins start
   ```

4. **Access Jenkins Dashboard:**
   Open a browser and go to:
   ```
   http://<your-public-ip>:8080
   ```

5. **Unlock Jenkins:**
   Retrieve the Jenkins unlock password with:
   ```bash
   sudo cat /var/lib/jenkins/secrets/initialAdminPassword
   ```
   Copy the password and paste it into the Jenkins setup page.

6. **Install Suggested Plugins:**
   Choose **"Install suggested plugins"** during the setup.

7. **Create User:**
   Create a dummy user (e.g., `par786`) and set a password.

8. **Finish Setup:**
   After the setup, the Jenkins dashboard will be accessible, and you're ready to create jobs.

---

## Creating Jenkins Jobs

### Job 1: Package Application (CI Job)
This job will pull the code from GitHub, build it using Maven, and package it into a `.war` file.

1. **Create a New Jenkins Job:**
   - Go to Jenkins Dashboard > **New Item**.
   - Name it **"Package Application"** and choose **Freestyle Project**.

2. **Configure GitHub Repository:**
   - Under **Source Code Management**, choose **Git**.
   - Enter the repository URL for the GitHub repository.

3. **Build Step:**
   - In the **Build** section, add a **"Execute shell"** step.
   - Enter the following Maven command:
     ```bash
     mvn clean package
     ```

4. **Post-build Actions:**
   - Archive the `.war` file after building:
     - Under **Post-build Actions**, add **Archive Artifacts**.
     - Specify the `.war` file path (e.g., `target/*.war`).

5. **Trigger the Job:**
   - Set the **GitHub hook trigger** for Git SCM polling to trigger this job whenever a change is made in the repository.

### Job 2: Deploy Application (CD Job)
This job will deploy the `.war` file generated by Job 1 to the Tomcat server.

1. **Create a New Jenkins Job:**
   - Go to Jenkins Dashboard > **New Item**.
   - Name it **"Deploy Application"** and choose **Freestyle Project**.

2. **Copy Artifact Plugin:**
   - Install the **Copy Artifact Plugin** to copy the `.war` file from Job 1.
   - Under **Build** section, add **"Copy artifacts from another project"**.
   - Choose **"Package Application"** as the source job and specify the artifact path.

3. **Install the Deploy to Container Plugin:**
   - Go to **Manage Jenkins** > **Manage Plugins**.
   - Install the **Deploy to Container Plugin**.
   - Once installed, configure it under **Post-build Actions** to deploy the `.war` file to Tomcat.

4. **Deploy to Tomcat:**
   - Configure the **Deploy WAR to Container** post-build action:
     - **File Path**: Enter the path to the `.war` file (e.g., `target/*.war`).
     - **Tomcat 9**: Choose Tomcat 9 as the target container.
     - **Credentials**: Enter the username and password for your Tomcat server.

---

## Setting Up Slave Nodes

### Creating and Configuring Slave Nodes:
To set up a slave node, Jenkins must be able to connect to it via SSH. Follow these steps:

1. **Configure Security Settings:**
   - In **Manage Jenkins**, enable "TCP port for inbound agent" to random. This allows Jenkins to connect to slave nodes.

2. **Install SSH Agent Plugin:**
   - Go to **Manage Jenkins** > **Manage Plugins** > **Available**, search for **"SSH Agent"**, and install it.

3. **Add a New Node:**
   - In **Manage Jenkins** > **Nodes** > **New Node**.
   - Name it (e.g., `Node1`), select **Permanent Agent**.
   - Set the **Launch method** to **Launch agents via SSH**.
   - Enter the **Remote root directory** (e.g., `/home/username/jenkins`).
   - Add the **SSH credentials** (username and private key).

4. **Verify Node:**
   - The node should show as **online**. If there are issues, ensure the SSH connection is working correctly.

---

## Creating CI/CD Pipeline

### Jenkins Pipeline for Deployment:
To automate the deployment process, you can create a Jenkins pipeline.

1. **Install Pipeline Plugin:**
   - Install the **Build Pipeline** plugin via **Manage Jenkins** > **Manage Plugins**.

2. **Create Pipeline View:**
   - Go to **New View** > Choose **Pipeline** and name it "CI/CD Pipeline".

3. **Add Jobs to Pipeline:**
   - Add the **"Push to Test"** job for the test environment.
   - Add the **"Push to Prod"** job for the production environment.

4. **Configure Pipeline Triggers:**
   - Set the pipeline to trigger automatically after a push to GitHub or any change in the repository.

---

## Final Configuration and Troubleshooting

1. **Test the Entire Pipeline:**
   - Commit changes to the GitHub repository, and confirm if Jenkins triggers the **Package Application** job, followed by **Deploy Application**.

2. **Check Job Status:**
   - Ensure both jobs are running correctly and the artifact is deployed to Tomcat. If there are errors, review logs for troubleshooting.

---

## Conclusion

With Jenkins set up for both CI and CD, you're able to automate your entire workflow, from pulling code from GitHub, building it with Maven, to deploying it on a Tomcat server. The integration of Jenkins with GitHub, slave nodes, and the deployment pipeline streamlines the development process, ensuring rapid and reliable application delivery.

Feel free to explore additional Jenkins features and plugins to further enhance your CI/CD workflow!

